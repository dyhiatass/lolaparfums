{% extends 'base.html.twig' %}

{% block title %}parfum homme
{% endblock %}
{% block body %}
	<section class="section ">
		<h2 class='section_titre'>
			seléction coffret
		</h2>
		<div class="section_products">
			{% for coffretsTendences in coffretsTendences %}
				<div class="section_product-card">
					<div class='container-image'>
								{% set promotion_url = null %}
							{% for detail in coffretsTendences.detailsParfums %}
								{% if detail.promotion and promotion_url is null %}
									{% set promotion_url = path('produits_promotions', { id: detail.id }) %}
								{% endif %}
							{% endfor %}

							{% if promotion_url %}
								<a href="{{ promotion_url }}">
									<img src="{{ asset('uploads/images/' ~ coffretsTendences.image) }}" alt="{{ coffretsTendences.nom }}" width="140" height="140">
								</a>
							{% else %}
								<a href="{{ path('produit_detail', { id: coffretsTendences.id }) }}">
									<img src="{{ asset('uploads/images/' ~ coffretsTendences.image) }}" alt="{{ coffretsTendences.nom }}" width="140" height="140">
								</a>
							{% endif %}
							</div>
					{% set has_promotion = false %}
                {% set pourcentage_promotion = 0 %}
                {% for detail in coffretsTendences.detailsParfums %}
                    {% if detail.promotion %}
                        {% set has_promotion = true %}
                        {% set pourcentage_promotion = detail.pourcentagePromotion %}
                    {% endif %}
                {% endfor %}
				{% if has_promotion %}
                    <div class="badge-promotion">
                        {{ pourcentage_promotion }}% 
                    </div>
                {% endif %}
					<span class='coffrets-marque'>{{ coffretsTendences.marque }}
					</span>
					<span class='coffrets-nom'>{{ coffretsTendences.nom }}</span>
					{% for prix in coffretsTendences.getPrix() %}
						<span class='coffrets-prix'>{{ prix }}
							€</span>
					{% endfor %}
				</div>
			{% endfor %}
		</div>
	</section>

	<div class="content">
		<div class="filters">
			<h2>Filtrer</h2>
			{{ form_start(form) }}
			<div class="form-group">
				{{ form_label(form.marque) }}
				{{ form_widget(form.marque) }}</div>
			<div class="form-group">
				{{ form_label(form.prix) }}
				{{ form_widget(form.prix) }}</div>
			<button type="submit">Appliquer</button>
			{{ form_end(form) }}
		</div>
		<section class="section_filter">
			<h2 class='section_titre'>Découvrer nos coffrets</h2>
			<div class="products">
				{% for coffret in coffrets %}
						<div class="product-card">
						<div class='container-image'>
								{% set promotion_url = null %}
								 {% set pourcentage_promotion = 0 %}
							{% for detail in coffret.detailsParfums %}
								{% if detail.promotion  %}
									{% set promotion_url = path('produits_promotions', { id: detail.id }) %}
									{% set pourcentage_promotion = detail.pourcentagePromotion %}
								{% endif %}
							{% endfor %}
							{% if promotion_url %}
								<a href="{{ promotion_url }}">
									<img src="{{ asset('uploads/images/' ~ coffret.image) }}" alt="{{ coffret.nom }}" width="140" height="140">
								</a>
								<div class="badge-promotion">{{ pourcentage_promotion }}% </div>
							{% else %}
								<a href="{{ path('produit_detail', { id: coffret.id }) }}">
									<img src="{{ asset('uploads/images/' ~ coffret.image) }}" alt="{{ coffret.nom }}" width="140" height="140">
								</a>
							{% endif %}
							</div>
							<span class='coffrets-marque'>{{ coffret.marque }}
							</span>
							<span class='coffrets-nom'>{{ coffret.nom }}</span>
							{% for prix in coffret.getPrix() %}
								<span class='coffrets-prix'>{{ prix }}
									€</span>
							{% endfor %}
						</div>
				{% endfor %}
			</div>
		</section>


	</div>
	<script>
		let currentSlide = 0;
const slides = document.querySelectorAll('.carousel-item');
const totalSlides = slides.length;

function changeSlide(direction) {
slides[currentSlide].classList.remove('active');
currentSlide = (currentSlide + direction + totalSlides) % totalSlides;
slides[currentSlide].classList.add('active');
}

setInterval(() => changeSlide(1), 5000); // Change de diapositive toutes les 5 secondes
	</script>

{% endblock %}
