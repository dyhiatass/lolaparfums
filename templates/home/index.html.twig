{% extends 'base.html.twig' %}

{% block title %}Home{% endblock %}

{% block body %}
	<div class="carousel">
		<div class="carousel-item active">
			<img src="{{ asset('caroussel/acqua-di-gio-profondo-parfum.jpg') }}" alt="Slide 1">
		</div>
		<div class="carousel-item">
			<img src="{{ asset('caroussel/armani-si.jpg') }}" alt="Slide 2">
		</div>
		<div class="carousel-item ">
			<img src="{{ asset('caroussel/coffret-armani-si.jpg') }}" alt="Slide 3">
		</div>
		<div class="carousel-item">
			<img src="{{ asset('caroussel/la vie est belle.jpg') }}" alt="Slide 3">
		</div>
		<div class="carousel-item">
			<img src="{{ asset('caroussel/terre-hermes-le-parfum.jpg') }}" alt="Slide 3">
		</div>
		<div class="carousel-controls">
			<button class="carousel-control prev" onclick="changeSlide(-1)">&#10094;</button>
			<button class="carousel-control next" onclick="changeSlide(1)">&#10095;</button>
		</div>
	</div>
	<section class="section ">
		<h2 class='section_titre'>seléction coffret</h2>
		
		<div class="section_products">
			{% for parfum in coffrets %}
				<div class="section_product-card">
					<div class='container-image'>
						{% set promotion_url = null %}
						{% set pourcentage_promotion = 0 %}
							{% for detail in parfum.detailsParfums %}
								{% if detail.promotion %}
								{% set pourcentage_promotion = detail.pourcentagePromotion %}
								{% set promotion_url = path('produits_promotions', { id: detail.id }) %}
								{% endif %}
							{% endfor %}
							{% if promotion_url %}
								<a href="{{ promotion_url }}">
									<img src="{{ asset('uploads/images/' ~ parfum.image) }}" alt="{{ parfum.nom }}" width="140" height="140">
								</a>
								<div class="badge-promotion">
							{{ pourcentage_promotion }}%
						        </div>
							{% else %}
								<a href="{{ path('produit_detail', { id: parfum.id }) }}">
									<img src="{{ asset('uploads/images/' ~ parfum.image) }}" alt="{{ parfum.nom }}" width="140" height="140">
								</a>
							{% endif %}
					</div>
					<span class='coffrets-marque'>{{ parfum.marque }}</span>
					<span class='coffrets-nom'>{{ parfum.nom }}</span>
					{% for prix in parfum.getPrix() %}
						<div class='coffrets-prix'><span class='prix'>{{ prix }}€</span></div>
					{% endfor %}
				</div>
			{% endfor %}
		</div>
	</section>

	<section class="section ">
		<h2 class='section_titre'>Meilleures Ventes</h2>
		<div class="section_products">
			{% for parfum in meilleursVente %}
				<div class="section_product-card">
					<div class='container-image'>
						{% set promotion_url = null %}
						{% set pourcentage_promotion = 0 %}
							{% for detail in parfum.detailsParfums %}
								{% if detail.promotion %}
								{% set pourcentage_promotion = detail.pourcentagePromotion %}
								{% set promotion_url = path('produits_promotions', { id: detail.id }) %}
								{% endif %}
							{% endfor %}
							{% if promotion_url %}
								<a href="{{ promotion_url }}"><img src="{{ asset('uploads/images/' ~ parfum.image) }}" alt="{{ parfum.nom }}" width="140" height="140"></a>
								<div class="badge-promotion">{{ pourcentage_promotion }}%</div>
							{% else %}
								<a href="{{ path('produit_detail', { id: parfum.id }) }}"><img src="{{ asset('uploads/images/' ~ parfum.image) }}" alt="{{ parfum.nom }}" width="140" height="140"></a>
							{% endif %}
					</div>
					<span class='coffrets-marque'>{{ parfum.marque }}</span>
					<span class='coffrets-nom'>{{ parfum.nom }}</span>{% set prix = parfum.getPrix() %}
					{% if not parfum.isCoffret %}
						<div class='coffrets-prix'><p class='prix_texte'>à partir de</p><span class='prix'>{{ min(prix) }}€</span></div>
					{% else %}
						<div class='coffrets-prix'><span class='prix'>{{ min(prix) }}€</span></div>
					{% endif %}
				</div>
			{% endfor %}
		</div>
	</section>

	<section class="section ">
		<h2 class='section_titre'>Tendances</h2>
		<div class="section_products">
			{% for parfum in tendances %}
				<div class="section_product-card">
					<div class='container-image'>
						{% set promotion_url = null %}
						{% set pourcentage_promotion = 0 %}
							{% for detail in parfum.detailsParfums %}
							{% set pourcentage_promotion = detail.pourcentagePromotion %}
								{% if detail.promotion and promotion_url is null %}
									{% set promotion_url = path('produits_promotions', { id: detail.id }) %}
								{% endif %}
							{% endfor %}

							{% if promotion_url %}
								<a href="{{ promotion_url }}">
									<img src="{{ asset('uploads/images/' ~ parfum.image) }}" alt="{{ parfum.nom }}" width="140" height="140">
					</a>
					<div class="badge-promotion">
							{{ pourcentage_promotion }}%
						</div>
							{% else %}
								<a href="{{ path('produit_detail', { id: parfum.id }) }}">
									<img src="{{ asset('uploads/images/' ~ parfum.image) }}" alt="{{ parfum.nom }}" width="140" height="140">
								</a>
							{% endif %}
					</div>
					<span class='coffrets-marque'>{{ parfum.marque }}
					</span>
					<span class='coffrets-nom'>{{ parfum.nom }}</span>
					{% set prix = parfum.getPrix() %}
					{% if not parfum.isCoffret %}
						<div class='coffrets-prix'>
							<p class='prix_texte'>à partir de</p>
							<span class='prix'>{{ min(prix) }}
								€</span>
						</div>
					{% else %}
						<div class='coffrets-prix'>
							<span class='prix'>{{ min(prix) }}
								€</span>
						</div>
					{% endif %}


				</div>
			{% endfor %}
		</div>
	</section>

	<section class="section_coupdecoeur ">
		<h2 class='section_titre'>Coups de Coeur</h2>
		<div class="section_products">
			{% for parfum in coupsDeCoeur %}
				<div class="section_product-card">
					<div class='container-image'>
						{% set promotion_url = null %}
							{% for detail in parfum.detailsParfums %}
								{% if detail.promotion and promotion_url is null %}
									{% set promotion_url = path('produits_promotions', { id: detail.id }) %}
								{% endif %}
							{% endfor %}

							{% if promotion_url %}
								<a href="{{ promotion_url }}">
									<img src="{{ asset('uploads/images/' ~ parfum.image) }}" alt="{{ parfum.nom }}" width="140" height="140">
								</a>
							{% else %}
								<a href="{{ path('produit_detail', { id: parfum.id }) }}">
									<img src="{{ asset('uploads/images/' ~ parfum.image) }}" alt="{{ parfum.nom }}" width="140" height="140">
								</a>
							{% endif %}
							
				</div>
					{% set has_promotion = false %}
					{% set pourcentage_promotion = 0 %}
					{% for detail in parfum.detailsParfums %}
						{% if detail.promotion %}
							{% set has_promotion = true %}
							{% set pourcentage_promotion = detail.pourcentagePromotion %}
						{% endif %}
					{% endfor %}

					{% if has_promotion %}
						<div class="badge-promotion">
							{{ pourcentage_promotion }}%
						</div>
					{% endif %}
					<span class='coffrets-marque'>{{ parfum.marque }}
					</span>
					<span class='coffrets-nom'>{{ parfum.nom }}</span>
					{% set prix = parfum.getPrix() %}
					{% if not parfum.isCoffret %}
						<div class='coffrets-prix'>
							<p class='prix_texte'>à partir de</p>
							<span class='prix'>{{ min(prix) }}
								€</span>
						</div>
					{% else %}
						<div class='coffrets-prix'>
							<span class='prix'>{{ min(prix) }}
								€</span>
						</div>
					{% endif %}

				</div>
			{% endfor %}
		</div>
	</section>

	<script>
		let currentSlide = 0;
const slides = document.querySelectorAll('.carousel-item');
const totalSlides = slides.length;

function changeSlide(direction) {
slides[currentSlide].classList.remove('active');
currentSlide = (currentSlide + direction + totalSlides) % totalSlides;
slides[currentSlide].classList.add('active');
}

setInterval(() => changeSlide(1), 5000); // Change de diapositive toutes les 5 secondes
	</script>

{% endblock %}
